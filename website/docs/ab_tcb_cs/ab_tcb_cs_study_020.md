# ç¬¬20ç« ï¼šãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã®è¨­è¨ˆï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰ğŸ’¬âš ï¸

---

## 20.1 ã“ã®ç« ã§ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ğŸ¯âœ¨

* ã€Œå¤±æ•—ã®ç¨®é¡ã€ã‚’æ•´ç†ã—ã¦ã€**ãƒã‚°ã‚Šã«ãã„ã‚¨ãƒ©ãƒ¼è¨­è¨ˆ**ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ğŸ˜Š
* **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¦‹ã›ã‚‹æ–‡è¨€**ã¨ã€**ãƒ­ã‚°ã«æ®‹ã™è©³ç´°**ã‚’åˆ†ã‘ã‚‰ã‚Œã‚‹ğŸ§¾ğŸ”
* é›†ç´„ã®ãƒ«ãƒ¼ãƒ«é•åï¼ˆä¾‹ï¼šç¢ºå®šå¾Œã®å¤‰æ›´ãªã©ï¼‰ã‚’ã€**ãã‚Œã„ã«æ‰±ãˆã‚‹**ã‚ˆã†ã«ãªã‚‹ğŸŒ³ğŸ”’

---

## 20.2 ã„ããªã‚Šçµè«–ï¼šã‚¨ãƒ©ãƒ¼ã¯â€œæ··ãœã‚‹ãªå±é™ºâ€ğŸš«ğŸ§ª

åˆå¿ƒè€…ãŒã‚„ã‚ŠãŒã¡ãªã®ãŒã“ã‚ŒğŸ‘‡

* ä½•ã§ã‚‚ `throw new Exception("ãªã‚“ã‹ãƒ€ãƒ¡")` ğŸ’¥
* ä¾‹å¤–ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾ç”»é¢ã«è¡¨ç¤ºğŸ˜±
* å¤±æ•—ã®ç†ç”±ãŒãƒãƒ©ãƒãƒ©ã§ã€UIå´ãŒå¯¾å¿œã§ããªã„ğŸ˜µ

ã“ã‚Œã‚’ç›´ã™ã«ã¯ã€ã¾ãš **ã€Œå¤±æ•—ã®ç¨®é¡ã€ã‚’åˆ†ã‘ã‚‹**ã®ãŒæœ€å¼·ã§ã™ğŸ’ªâœ¨

---

## 20.3 å¤±æ•—ã¯3ç¨®é¡ã«åˆ†ã‘ã‚‹ï¼ˆè¶…é‡è¦ï¼‰ğŸ§ âš–ï¸

![ã‚¨ãƒ©ãƒ¼ã®æ¨™è­˜](./picture/ab_tcb_cs_study_020_errors.png)


### A) ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆæƒ³å®šå†…ã®å¤±æ•—ï¼‰ğŸ§¾âœ…

æ¥­å‹™ãƒ«ãƒ¼ãƒ«çš„ã«ã€Œãã‚Œã¯ãƒ€ãƒ¡ã ã‚ˆã­ã€ã£ã¦ã‚„ã¤ã€‚

* ä¾‹ï¼šæ³¨æ–‡ãŒç¢ºå®šæ¸ˆã¿ãªã®ã«æ˜ç´°è¿½åŠ ã—ã‚ˆã†ã¨ã—ãŸğŸ§¾ğŸš«
* ä¾‹ï¼šåœ¨åº«ãŒè¶³ã‚Šãªã„ğŸ“¦âŒ
* ä¾‹ï¼šã‚¯ãƒ¼ãƒãƒ³æœŸé™åˆ‡ã‚ŒğŸ«âŒ›

ğŸ‘‰ **Resultå‹ã§è¿”ã™**ã®ãŒç›¸æ€§â—ï¼ˆå¾Œã§è©³ã—ãï¼‰âœ¨

### B) å…¥åŠ›ã‚¨ãƒ©ãƒ¼ï¼ˆValidationï¼‰ğŸ“âš ï¸

å€¤ãŒå¤‰ãƒ»ä¸è¶³ãªã©ã€‚

* ä¾‹ï¼šå€‹æ•°ãŒ0ã€é‡‘é¡ãŒãƒã‚¤ãƒŠã‚¹ã€å¿…é ˆé …ç›®ãŒç©ºğŸ˜µâ€ğŸ’«

ğŸ‘‰ ã“ã‚Œã¯ UI / API ã®å…¥å£ã§æ—©ã‚ã«å¼¾ãã®ãŒâ—ğŸ‘®â€â™€ï¸âœ¨

### C) ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ï¼ˆæƒ³å®šå¤–ãƒ»éšœå®³ï¼‰ğŸ”¥ğŸ§¯

ã‚¢ãƒ—ãƒªã®éƒ½åˆã§èµ·ãã‚‹ã‚„ã¤ã€‚

* DBæ¥ç¶šãŒè½ã¡ãŸğŸ’¾ğŸ’¥
* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ğŸŒâš¡
* ãƒã‚°ã§ NullReferenceException ğŸ¤•

ğŸ‘‰ ã“ã‚Œã¯ **ä¾‹å¤–ï¼ˆExceptionï¼‰**ã§OKã€‚
ãŸã ã—ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è©³ç´°ã‚’è¦‹ã›ãªã„**ã®ãŒé‰„å‰‡ğŸ«¶ğŸ§¾

---

## 20.4 ã€Œä¾‹å¤–ã€ã£ã¦ã©ã“ã¾ã§æŠ•ã’ã¦ã„ã„ã®ï¼ŸğŸ¤”ğŸ’¥

### ä¾‹å¤–ã‚’æŠ•ã’ã¦ã„ã„ã‚±ãƒ¼ã‚¹âœ…

* â€œæœ¬æ¥ã‚ã‚Šãˆãªã„çŠ¶æ…‹â€ï¼**ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒã‚°**ã‚’ç¤ºã™ã¨ãğŸ›
* ã‚¤ãƒ³ãƒ•ãƒ©éšœå®³ï¼ˆDBãƒ»å¤–éƒ¨APIãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ï¼‰ğŸš§

### ä¾‹å¤–ã‚’æŠ•ã’ãªã„æ–¹ãŒã„ã„ã‚±ãƒ¼ã‚¹ğŸš«

* æ¥­å‹™ãƒ«ãƒ¼ãƒ«é•åï¼ˆï¼ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã§æ™®é€šã«èµ·ãã†ã‚‹ï¼‰ğŸ™…â€â™€ï¸
  â†’ ä¾‹å¤–ã§æ­¢ã‚ã‚‹ã¨ã€åˆ¶å¾¡ãŒã‚®ã‚¯ã‚·ãƒ£ã‚¯ã—ãŒã¡ğŸ˜µ

---

## 20.5 Resultå‹ã£ã¦ãªã«ï¼Ÿï¼ˆè¶…ã‚„ã•ã—ãï¼‰ğŸ¬

Resultå‹ã¯ã€ã–ã£ãã‚Šè¨€ã†ã¨ğŸ‘‡

* æˆåŠŸãªã‚‰ âœ…ã€ŒOKã€
* å¤±æ•—ãªã‚‰ âŒã€Œã“ã®ç†ç”±ã§ãƒ€ãƒ¡ã€

ã‚’ **å‹ã§è¡¨ã™**ã‚„ã‚Šæ–¹ã§ã™âœ¨

---

## 20.6 â€œãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸â€ã¨â€œãƒ­ã‚°ã®è©³ç´°â€ã‚’åˆ†ã‘ã‚‹ğŸ§¾ğŸ”

### ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ğŸ’¬ğŸŒ¸

* ã‚„ã•ã—ã„
* çŸ­ã„
* æ¬¡ã«ã©ã†ã™ã‚Œã°ã„ã„ã‹ãŒåˆ†ã‹ã‚‹

ä¾‹ï¼š

* ã€Œæ³¨æ–‡ã¯ã™ã§ã«ç¢ºå®šæ¸ˆã¿ã§ã™ã€‚å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦ãã ã•ã„ã€‚ã€ğŸ™

### ãƒ­ã‚°å‘ã‘ğŸ”ğŸ§‘â€ğŸ’»

* å…·ä½“çš„
* è§£æã§ãã‚‹
* ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚„ä¾‹å¤–æƒ…å ±ã¤ã

ä¾‹ï¼š

* `OrderId=..., Status=Confirmed, Command=AddItem, UserId=...` ğŸ§©

---

## 20.7 å®Ÿè£…ã—ã¦ã¿ã‚ˆã†ï¼šDomainError + Resultï¼ˆæœ€å°ã‚»ãƒƒãƒˆï¼‰ğŸ› ï¸âœ¨

ã¾ãšã¯ã€Œã‚¨ãƒ©ãƒ¼ã¯ã‚³ãƒ¼ãƒ‰ã§è­˜åˆ¥ã€ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã®ãŒã‚³ãƒ„ğŸ†”ğŸ’¡
ï¼ˆæ–‡è¨€ã ã‘ã ã¨å¾Œã§å´©å£Šã—ã‚„ã™ã„â€¦ï¼ğŸ˜‡ï¼‰

```csharp
// ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼šæ¥­å‹™ãƒ«ãƒ¼ãƒ«é•åã‚’è¡¨ã™ã€Œã‚¨ãƒ©ãƒ¼ã€
public sealed record DomainError(string Code, string Message);

// æˆåŠŸ/å¤±æ•—ã ã‘ã® Result
public readonly record struct Result(bool IsSuccess, DomainError? Error)
{
    public static Result Ok() => new(true, null);
    public static Result Fail(DomainError error) => new(false, error);
}

// å€¤ã‚’è¿”ã—ãŸã„ç‰ˆ
public readonly record struct Result<T>(bool IsSuccess, T? Value, DomainError? Error)
{
    public static Result<T> Ok(T value) => new(true, value, null);
    public static Result<T> Fail(DomainError error) => new(false, default, error);
}
```

---

## 20.8 ä¾‹ï¼šæ³¨æ–‡ï¼ˆOrderï¼‰é›†ç´„ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ğŸŒ³â˜•ï¸

ã€Œç¢ºå®šæ¸ˆã¿ãªã‚‰å¤‰æ›´ã§ããªã„ã€ã¿ãŸã„ãªãƒ«ãƒ¼ãƒ«ã‚’ã€é›†ç´„ãŒå®ˆã‚‹ã‚“ã ã£ãŸã‚ˆã­ğŸ”âœ¨
ãã®ã¨ãã€ä¾‹å¤–ã˜ã‚ƒãªã Result ã§è¿”ã—ã¦ã¿ã‚‹ğŸ‘‡

```csharp
public enum OrderStatus { Draft, Confirmed, Cancelled }

public static class OrderErrors
{
    public static DomainError AlreadyConfirmed(Guid orderId)
        => new("order.already_confirmed", $"æ³¨æ–‡ã¯ç¢ºå®šæ¸ˆã¿ã§ã™ (OrderId={orderId})");

    public static DomainError InvalidQuantity(int quantity)
        => new("order.invalid_quantity", $"æ•°é‡ãŒä¸æ­£ã§ã™ (Quantity={quantity})");
}

public sealed class Order
{
    public Guid Id { get; }
    public OrderStatus Status { get; private set; } = OrderStatus.Draft;

    private readonly List<(string ItemName, int Quantity)> _items = new();

    public Order(Guid id) => Id = id;

    public Result AddItem(string itemName, int quantity)
    {
        if (Status != OrderStatus.Draft)
            return Result.Fail(OrderErrors.AlreadyConfirmed(Id));

        if (quantity <= 0)
            return Result.Fail(OrderErrors.InvalidQuantity(quantity));

        _items.Add((itemName, quantity));
        return Result.Ok();
    }

    public Result Confirm()
    {
        if (Status != OrderStatus.Draft)
            return Result.Fail(OrderErrors.AlreadyConfirmed(Id));

        Status = OrderStatus.Confirmed;
        return Result.Ok();
    }
}
```

ãƒã‚¤ãƒ³ãƒˆğŸ€

* ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯ã€Œå¤±æ•—ç†ç”±ã€ã‚’è¿”ã™ã ã‘ï¼ˆUIã®è¦‹ã›æ–¹ã¯çŸ¥ã‚‰ãªã„ï¼‰ğŸ§ 
* ã‚¨ãƒ©ãƒ¼ã® **Code** ãŒã‚ã‚‹ã‹ã‚‰ã€UIå´ã§åˆ†å²ã—ã‚„ã™ã„ğŸ†”âœ¨

---

## 20.9 å¢ƒç•Œï¼ˆã‚¢ãƒ—ãƒªå±¤ï¼‰ã§ã‚¨ãƒ©ãƒ¼ã‚’â€œæ•´å½¢â€ã™ã‚‹âœ¨ğŸ§

ã“ã“ãŒã“ã®ç« ã®ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒï¼ğŸ¬ğŸ”’
**ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å¤±æ•—**ã‚’ã€ã‚¢ãƒ—ãƒªå±¤ã§ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®å½¢ã€ã«æ•´ãˆã‚‹ã‚ˆğŸ’¬âœ¨

---

### 20.9.1 Web APIãªã‚‰ Problem Details ãŒä¾¿åˆ©ï¼ˆæ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰ğŸ“¦ğŸŒ

ASP.NET Core ã«ã¯ Problem Detailsï¼ˆå•é¡Œè©³ç´°ï¼‰ã‚’æ‰±ã†ä»•çµ„ã¿ãŒã‚ã‚Šã€`AddProblemDetails` ãªã©ã§çµ±ä¸€ã—ã‚„ã™ã„ã‚ˆğŸ§©âœ¨ ([Microsoft Learn][1])
ãªãŠã€Problem Details ã®å…ƒä»•æ§˜ã¯ RFC 7807 ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦èª¬æ˜ã•ã‚Œã¦ã„ã¦([Microsoft Learn][2])ã€æ–°ã—ã„ RFC 9457 ãŒ RFC 7807 ã‚’ç½®ãæ›ãˆãŸï¼ˆobsoletesï¼‰å½¢ã ã‚ˆğŸ“œâœ¨ ([RFC ã‚¨ãƒ‡ã‚£ã‚¿][3])

---

### 20.9.2 Result â†’ HTTPå¿œç­”ã«å¤‰æ›ã™ã‚‹ï¼ˆæœ€å°APIä¾‹ï¼‰ğŸš€

```csharp
using Microsoft.AspNetCore.Mvc;

var builder = WebApplication.CreateBuilder(args);

// ProblemDetails ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ï¼ˆçµ±ä¸€ã—ãŸã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã«å½¹ç«‹ã¤ï¼‰
builder.Services.AddProblemDetails(); // :contentReference[oaicite:3]{index=3}

var app = builder.Build();

app.MapPost("/orders/{id:guid}/items", (Guid id, AddItemRequest req) =>
{
    // ã“ã“ã§ã¯èª¬æ˜ã®ãŸã‚ç›´å‘¼ã³ï¼ˆæœ¬ç•ªã¯Application Serviceã«å¯„ã›ã‚‹ï¼‰
    var order = new Order(id);

    var result = order.AddItem(req.ItemName, req.Quantity);

    if (result.IsSuccess) return Results.Ok();

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã¯ã€Œã‚„ã•ã—ãçŸ­ãã€ğŸ’¬
    // è©³ç´°ã¯ extensions ã«å¯„ã›ã¦ãƒ­ã‚°ã‚„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ğŸ§¾
    return Results.Problem(
        title: "æ³¨æ–‡ã‚’æ›´æ–°ã§ãã¾ã›ã‚“ã§ã—ãŸ",
        statusCode: 400,
        extensions: new Dictionary<string, object?>
        {
            ["code"] = result.Error!.Code,
            ["message"] = "å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦ã€ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ ğŸ™"
        });
});

app.Run();

public sealed record AddItemRequest(string ItemName, int Quantity);
```

ã‚³ãƒ„ğŸª„

* `title` ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ï¼ˆçŸ­ãï¼‰ğŸ’¬
* `code` ã¯æ©Ÿæ¢°å‘ã‘ï¼ˆUIåˆ†å²ãƒ»ç¿»è¨³ã‚­ãƒ¼ï¼‰ğŸ†”
* ãƒ‰ãƒ¡ã‚¤ãƒ³ã® `Message` ã‚’ãã®ã¾ã¾å‡ºã™ã®ã¯é¿ã‘ãŒã¡ï¼ˆå†…éƒ¨æƒ…å ±ã«ãªã‚Šã‚„ã™ã„ï¼‰ğŸ”

---

## 20.10 â€œãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸â€ã¯ã©ã“ã¾ã§æ›¸ãï¼ŸğŸ¤”ğŸ§¾

ãŠã™ã™ã‚ã®è€ƒãˆæ–¹ğŸ‘‡âœ¨

* ãƒ‰ãƒ¡ã‚¤ãƒ³ã® `Message` ã¯ã€Œé–‹ç™ºè€…ãŒç†è§£ã§ãã‚‹æƒ…å ±ã€å¯„ã‚ŠğŸ§‘â€ğŸ’»
* UIè¡¨ç¤ºã¯ã€ã‚¢ãƒ—ãƒªå±¤ã§ **Codeâ†’è¡¨ç¤ºæ–‡è¨€** ã«å¤‰æ›ğŸ’¬ğŸŒ¸

  * å°†æ¥ã€æ–‡è¨€ã‚’å¤‰ãˆã¦ã‚‚ã‚³ãƒ¼ãƒ‰ã¯åŒã˜ã§OKğŸª„
  * å¤šè¨€èªåŒ–ã‚‚ã—ã‚„ã™ã„ğŸŒ

---

## 20.11 ã€Œæœ€æ–°ã®C#/.NETã€å‰æã¨ã—ã¦æŠ¼ã•ãˆã‚‹å°ãƒã‚¿ğŸ“Œâœ¨

* .NET ã®æœ€æ–°LTSã¯ **.NET 10ï¼ˆ2025-11-11ãƒªãƒªãƒ¼ã‚¹ã€2026-01-13æ™‚ç‚¹ã§ 10.0.2 ãªã©ã®æ›´æ–°ï¼‰** ([Microsoft][4])
* C# ã®æœ€æ–°ã¯ **C# 14ï¼ˆ.NET 10 ä¸Šã§ã‚µãƒãƒ¼ãƒˆï¼‰** ([Microsoft Learn][5])
* EF Core ã‚‚ **EF Core 10** ãŒ .NET 10 ä¸–ä»£ã§LTSï¼ˆ.NET 10 ãŒå¿…é ˆï¼‰ ([Microsoft Learn][6])

ã“ã®ç« ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã“ã†ã„ã†â€œä»Šã©ãå‰æâ€ã§ã‚¹ãƒ ãƒ¼ã‚ºã«é€šã‚‹æ„Ÿã˜ã ã‚ˆğŸ˜Šâœ¨

---

## 20.12 ã‚ˆãã‚ã‚‹è¨­è¨ˆãƒŸã‚¹ã‚ã‚‹ã‚ã‚‹ï¼ˆå…ˆã«æ½°ã™ï¼‰ğŸ’¥ğŸ˜‡

* âŒ ã‚¨ãƒ©ãƒ¼æ–‡è¨€ã§ `if (message.Contains("ç¢ºå®šæ¸ˆã¿"))` ã¿ãŸã„ãªåˆ†å²
  â†’ æ–‡å­—ãŒå¤‰ã‚ã£ãŸç¬é–“ã«æ­»ã¬ğŸ˜‡
* âŒ ä¾‹å¤–ã‚’æ¡ã‚Šã¤ã¶ã—ã¦ `return null;`
  â†’ åŸå› ãŒæ¶ˆãˆã¦ã€å¾Œã§åœ°ç„ğŸ‘»
* âŒ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§ãƒ­ã‚°ã‚’æ›¸ãã¾ãã‚‹
  â†’ ä¾å­˜ãŒå¢—ãˆã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒæ±šã‚ŒãŒã¡ğŸ§¼

---

## 20.13 ãƒŸãƒ‹æ¼”ç¿’ï¼ˆæ‰‹ã‚’å‹•ã‹ã™ï¼‰âœï¸ğŸ€

### æ¼”ç¿’Aï¼šã‚¨ãƒ©ãƒ¼ä¸€è¦§ã‚’ä½œã‚‹ğŸ—’ï¸âœ¨

ã‚«ãƒ•ã‚§æ³¨æ–‡ã§ã€æœ€ä½ã“ã‚Œã ã‘ Code ã‚’ä½œã£ã¦ã¿ã‚ˆã†ğŸ‘‡â˜•ï¸

* `order.already_confirmed`ï¼ˆç¢ºå®šæ¸ˆã¿ã§å¤‰æ›´ä¸å¯ï¼‰
* `order.invalid_quantity`ï¼ˆæ•°é‡ä¸æ­£ï¼‰
* `payment.method_not_allowed`ï¼ˆæ”¯æ‰•ã„æ–¹æ³•NGï¼‰
* `inventory.not_enough`ï¼ˆåœ¨åº«ä¸è¶³ï¼‰

### æ¼”ç¿’Bï¼šCodeâ†’è¡¨ç¤ºæ–‡è¨€ã®è¾æ›¸ã‚’ä½œã‚‹ğŸ“–ğŸ’¬

ã‚¢ãƒ—ãƒªå±¤ã«ã€Œè¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¾æ›¸ã€ã‚’ç½®ã„ã¦ã¿ã‚ˆã†ğŸŒ¸

* ä¾‹ï¼š`order.already_confirmed` â†’ ã€Œæ³¨æ–‡ã¯ç¢ºå®šæ¸ˆã¿ã§ã™ã€‚å¤‰æ›´ã§ãã¾ã›ã‚“ğŸ™ã€

### æ¼”ç¿’Cï¼šProblem Details ã« `code` ã‚’å¿…ãšå…¥ã‚Œã‚‹ğŸ§©

å¤±æ•—æ™‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« `extensions["code"]` ã‚’å¸¸ã«å…¥ã‚Œã‚‹ãƒ«ãƒ¼ãƒ«ã«ã—ã¦ã¿ã‚ˆã†ğŸ†”âœ¨ ([Microsoft Learn][1])

---

## 20.14 Copilot / Codex ã‚’ä½¿ã†ã‚³ãƒ„ï¼ˆä¸¸æŠ•ã’ç¦æ­¢ã®å‹ï¼‰ğŸ¤–âœ¨

ä½¿ã„ã©ã“ã‚ã¯ã“ã“ãŒå¼·ã„ã‚ˆğŸ‘‡

* ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰æ¡ˆã‚’ã¾ã¨ã‚ã¦ã‚‚ã‚‰ã†ğŸ†”ğŸ§ 
* è¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¡ˆã‚’â€œã‚„ã•ã—ã„æ—¥æœ¬èªâ€ã§ä½œã£ã¦ã‚‚ã‚‰ã†ğŸ’¬ğŸŒ¸
* Resultâ†’HTTPå¤‰æ›ã®ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦ã‚‚ã‚‰ã†ğŸ§©

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ï¼ˆãã®ã¾ã¾ä½¿ãˆã‚‹ï¼‰ğŸª„

* ã€Œã‚«ãƒ•ã‚§æ³¨æ–‡ãƒ‰ãƒ¡ã‚¤ãƒ³ã§èµ·ã“ã‚Šã†ã‚‹æ¥­å‹™ãƒ«ãƒ¼ãƒ«é•åã‚’10å€‹æŒ™ã’ã¦ã€`code` ã‚’ `snake.case` ã§ææ¡ˆã—ã¦ã€
* ã€Œ`order.already_confirmed` ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ã€è²¬ã‚ãªã„ãƒ»çŸ­ã„ãƒ»æ¬¡ã®è¡Œå‹•ãŒåˆ†ã‹ã‚‹æ–‡ã«ã—ã¦ï¼ˆå€™è£œ5ã¤ï¼‰ã€
* ã€ŒResultå‹ã®å¤±æ•—ã‚’ ProblemDetails ã«å¤‰æ›ã™ã‚‹æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ›¸ã„ã¦ã€‚`extensions.code` ã‚’å¿…ãšå…¥ã‚Œã¦ã€

âš ï¸æœ€å¾Œã«å¿…ãšã‚„ã‚‹ã“ã¨

* ç”Ÿæˆç‰©ã® `code` ãŒãƒ–ãƒ¬ã¦ãªã„ã‹ç¢ºèªğŸ§¾
* UIè¡¨ç¤ºæ–‡è¨€ãŒâ€œå†…éƒ¨æƒ…å ±â€ã‚’æ¼ã‚‰ã—ã¦ãªã„ã‹ç¢ºèªğŸ”
* ä¾‹å¤–ã«ã™ã¹ãã‚±ãƒ¼ã‚¹ï¼ˆéšœå®³ãƒ»ãƒã‚°ï¼‰ã¾ã§ Result ã«ã—ã¦ãªã„ã‹ç¢ºèªğŸ’¥

---

## 20.15 ã¾ã¨ã‚ğŸâœ¨

* ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆæƒ³å®šå†…ï¼‰ï¼ **Resultã§è¿”ã™**ã®ãŒæ‰±ã„ã‚„ã™ã„âœ…
* ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ï¼ˆæƒ³å®šå¤–ï¼‰ï¼ **ä¾‹å¤–ã§OKã€ã§ã‚‚è¡¨ç¤ºã¯ã‚„ã•ã—ã**ğŸ§¯
* **ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘**ã¨**ãƒ­ã‚°å‘ã‘**ã¯åˆ†ã‘ã‚‹ğŸ§¾ğŸ”
* å¢ƒç•Œï¼ˆã‚¢ãƒ—ãƒªå±¤ï¼‰ã§ã‚¨ãƒ©ãƒ¼ã‚’æ•´å½¢ã—ã¦ã€è¿”ã™å½¢ã‚’çµ±ä¸€ã™ã‚‹âœ¨
* Web APIãªã‚‰ Problem Details ãŒä¾¿åˆ©ã§ã€ä»Šã¯ RFC 7807 ãƒ™ãƒ¼ã‚¹ã®èª¬æ˜ãŒå¤šã„ã‘ã©ã€æ–°ã—ã„ RFC 9457 ãŒ RFC 7807 ã‚’ç½®ãæ›ãˆãŸæµã‚Œã‚‚æŠ¼ã•ãˆã‚‹ã¨å®‰å¿ƒğŸ“œğŸŒ¸ ([Microsoft Learn][2])

[1]: https://learn.microsoft.com/en-us/aspnet/core/fundamentals/error-handling-api?view=aspnetcore-10.0&utm_source=chatgpt.com "Handle errors in ASP.NET Core APIs"
[2]: https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.problemdetails?view=aspnetcore-10.0&utm_source=chatgpt.com "ProblemDetails Class (Microsoft.AspNetCore.Mvc)"
[3]: https://www.rfc-editor.org/rfc/rfc9457.html?utm_source=chatgpt.com "RFC 9457: Problem Details for HTTP APIs"
[4]: https://dotnet.microsoft.com/en-us/platform/support/policy/dotnet-core?utm_source=chatgpt.com "NET and .NET Core official support policy"
[5]: https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-14?utm_source=chatgpt.com "What's new in C# 14"
[6]: https://learn.microsoft.com/en-us/ef/core/what-is-new/ef-core-10.0/whatsnew?utm_source=chatgpt.com "What's New in EF Core 10"
