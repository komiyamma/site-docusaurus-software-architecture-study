非同期処理を含む状態遷移の設計。中間状態を導入して待機時間を表現し、非同期処理の完了をイベントとして扱うことで、安全な実装を実現する。